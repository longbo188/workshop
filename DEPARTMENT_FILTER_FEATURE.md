# 派工分配界面部门筛选功能

## 功能概述
为派工分配界面添加了部门筛选功能，允许主管按照部门来筛选和查看任务分配情况。

## 实现的功能

### 1. 部门筛选下拉框
- 在筛选区域添加了部门选择下拉框
- 自动从用户数据中提取所有部门列表
- 支持"全部部门"选项来清除部门筛选

### 2. 筛选逻辑
- **未分配任务**：显示有该部门用户的任务
- **已分配任务**：只显示分配给该部门用户的任务
- 支持与其他筛选条件（优先级、状态、阶段）组合使用

### 3. 数据获取
- 从用户表自动获取部门列表
- 去重并排序显示
- 过滤掉空值和空字符串

### 4. 清除功能
- 更新了"清除筛选"按钮，包含部门筛选的清除
- 更新了"清除所有筛选"功能

## 技术实现

### TypeScript 文件修改 (`dispatch.page.ts`)
1. 添加了 `selectedDepartment` 属性
2. 添加了 `departments` 数组来存储部门列表
3. 在 `loadData()` 方法中提取部门数据
4. 在 `getFilteredTasks()` 方法中实现部门筛选逻辑
5. 更新了 `clearFilters()` 和 `clearAllFilters()` 方法

### HTML 模板修改 (`dispatch.page.html`)
1. 在筛选区域添加了部门选择下拉框
2. 调整了布局，将生产阶段和部门并排显示
3. 使用 `*ngFor` 循环显示部门选项

## 使用方法
1. 进入派工分配界面
2. 点击"筛选"按钮展开筛选选项
3. 在"部门"下拉框中选择要筛选的部门
4. 系统会自动筛选显示相关任务
5. 可以与其他筛选条件组合使用
6. 点击"清除筛选"可以重置所有筛选条件

## 测试数据
当前测试数据包含以下部门：
- IT部门
- 生产部
- 组装车间
- 质检车间
- 包装车间

## 注意事项
- 部门筛选基于用户表中的 `department` 字段
- 未分配的任务会显示有该部门用户的任务
- 已分配的任务只显示分配给该部门用户的任务
- 部门列表会自动更新，无需手动维护





































